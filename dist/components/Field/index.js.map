{"version":3,"sources":["../../../src/components/Field/index.tsx"],"sourcesContent":["import type { I18nClient } from '@payloadcms/translations'\nimport type { TextFieldServerProps } from 'payload'\n\nimport type { CustomTranslationsKeys, CustomTranslationsObject } from '../../i18n/types.js'\nimport type { PayloadTOTPConfig, UserWithTotp } from '../../types.js'\n\nimport styles from './index.module.css'\nimport Remove from './Remove.js'\nimport Setup from './Setup.js'\n\ntype Args = {\n\tpluginOptions: PayloadTOTPConfig\n} & TextFieldServerProps\n\nexport const TOTPField = (args: Args) => {\n\tconst pluginOptions = args.pluginOptions\n\tconst i18n = args.i18n as I18nClient<CustomTranslationsObject, CustomTranslationsKeys>\n\tconst {\n\t\tdata: { id },\n\t\tpayload,\n\t\treq: { url },\n\t\tuser: _user,\n\t} = args\n\n\tconst user = _user as unknown as UserWithTotp\n\n\tif (!user || user.id !== id) {\n\t\treturn null\n\t}\n\n\treturn (\n\t\t<div className={styles.root} id=\"totp-ui-field\">\n\t\t\t<svg aria-hidden=\"true\" height=\"24\" version=\"1.1\" viewBox=\"0 0 24 24\" width=\"24\">\n\t\t\t\t<path d=\"M10.25 5.25A.75.75 0 0 1 11 4.5h2A.75.75 0 0 1 13 6h-2a.75.75 0 0 1-.75-.75ZM12 19.5a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z\"></path>\n\t\t\t\t<path d=\"M4 2.75C4 1.784 4.784 1 5.75 1h12.5c.966 0 1.75.784 1.75 1.75v18.5A1.75 1.75 0 0 1 18.25 23H5.75A1.75 1.75 0 0 1 4 21.25Zm1.75-.25a.25.25 0 0 0-.25.25v18.5c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25V2.75a.25.25 0 0 0-.25-.25Z\"></path>\n\t\t\t</svg>\n\t\t\t<div className={styles.text}>\n\t\t\t\t<label className=\"field-label\">\n\t\t\t\t\t{i18n.t('totpPlugin:authApp')}\n\t\t\t\t\t{user.hasTotp && (\n\t\t\t\t\t\t<span className={styles.status}>{i18n.t('totpPlugin:configured')}</span>\n\t\t\t\t\t)}\n\t\t\t\t</label>\n\t\t\t\t<span className={styles.description}>{i18n.t('totpPlugin:fieldDescription')}</span>\n\t\t\t</div>\n\t\t\t<div className={styles.action}>\n\t\t\t\t{user.hasTotp && !pluginOptions.forceSetup && (\n\t\t\t\t\t<Remove\n\t\t\t\t\t\ti18n={i18n}\n\t\t\t\t\t\tpayload={payload}\n\t\t\t\t\t\tpluginOptions={pluginOptions}\n\t\t\t\t\t\tuser={user}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t\t{!user.hasTotp && !pluginOptions.forceSetup && (\n\t\t\t\t\t<Setup backUrl={url} i18n={i18n} payload={payload} />\n\t\t\t\t)}\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n"],"names":["styles","Remove","Setup","TOTPField","args","pluginOptions","i18n","data","id","payload","req","url","user","_user","div","className","root","svg","aria-hidden","height","version","viewBox","width","path","d","text","label","t","hasTotp","span","status","description","action","forceSetup","backUrl"],"mappings":";AAMA,OAAOA,YAAY,qBAAoB;AACvC,OAAOC,YAAY,cAAa;AAChC,OAAOC,WAAW,aAAY;AAM9B,OAAO,MAAMC,YAAY,CAACC;IACzB,MAAMC,gBAAgBD,KAAKC,aAAa;IACxC,MAAMC,OAAOF,KAAKE,IAAI;IACtB,MAAM,EACLC,MAAM,EAAEC,EAAE,EAAE,EACZC,OAAO,EACPC,KAAK,EAAEC,GAAG,EAAE,EACZC,MAAMC,KAAK,EACX,GAAGT;IAEJ,MAAMQ,OAAOC;IAEb,IAAI,CAACD,QAAQA,KAAKJ,EAAE,KAAKA,IAAI;QAC5B,OAAO;IACR;IAEA,qBACC,MAACM;QAAIC,WAAWf,OAAOgB,IAAI;QAAER,IAAG;;0BAC/B,MAACS;gBAAIC,eAAY;gBAAOC,QAAO;gBAAKC,SAAQ;gBAAMC,SAAQ;gBAAYC,OAAM;;kCAC3E,KAACC;wBAAKC,GAAE;;kCACR,KAACD;wBAAKC,GAAE;;;;0BAET,MAACV;gBAAIC,WAAWf,OAAOyB,IAAI;;kCAC1B,MAACC;wBAAMX,WAAU;;4BACfT,KAAKqB,CAAC,CAAC;4BACPf,KAAKgB,OAAO,kBACZ,KAACC;gCAAKd,WAAWf,OAAO8B,MAAM;0CAAGxB,KAAKqB,CAAC,CAAC;;;;kCAG1C,KAACE;wBAAKd,WAAWf,OAAO+B,WAAW;kCAAGzB,KAAKqB,CAAC,CAAC;;;;0BAE9C,MAACb;gBAAIC,WAAWf,OAAOgC,MAAM;;oBAC3BpB,KAAKgB,OAAO,IAAI,CAACvB,cAAc4B,UAAU,kBACzC,KAAChC;wBACAK,MAAMA;wBACNG,SAASA;wBACTJ,eAAeA;wBACfO,MAAMA;;oBAGP,CAACA,KAAKgB,OAAO,IAAI,CAACvB,cAAc4B,UAAU,kBAC1C,KAAC/B;wBAAMgC,SAASvB;wBAAKL,MAAMA;wBAAMG,SAASA;;;;;;AAK/C,EAAC"}