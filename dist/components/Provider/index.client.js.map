{"version":3,"sources":["../../../src/components/Provider/index.client.tsx"],"sourcesContent":["/* eslint-disable no-restricted-exports */\n\n'use client'\n\nimport { useAuth } from '@payloadcms/ui'\nimport { usePathname, useRouter } from 'next/navigation.js'\nimport { useEffect } from 'react'\n\nimport type { UserWithTotp } from '../../types.js'\n\ntype Args = {\n\tchildren: React.ReactNode\n\tforceSetup?: boolean\n\tsetupUrl: string\n\tverifyUrl: string\n}\n\nexport default function TOTPProviderClient(args: Args) {\n\tconst { children, forceSetup, setupUrl, verifyUrl } = args\n\tconst { user } = useAuth<UserWithTotp>()\n\tconst strategy = (user as any)?._strategy\n\tconst router = useRouter()\n\tconst pathname = usePathname()\n\n\tuseEffect(() => {\n\t\tif (\n\t\t\tuser &&\n\t\t\tuser.hasTotp &&\n\t\t\tstrategy &&\n\t\t\t!['api-key', 'totp'].includes(strategy) &&\n\t\t\tpathname !== verifyUrl\n\t\t) {\n\t\t\trouter.push(`${verifyUrl}?back=${encodeURIComponent(pathname)}`)\n\t\t} else if (\n\t\t\tuser &&\n\t\t\t!user.hasTotp &&\n\t\t\tforceSetup &&\n\t\t\tpathname !== setupUrl &&\n\t\t\tstrategy !== 'api-key'\n\t\t) {\n\t\t\trouter.push(`${setupUrl}?back=${encodeURIComponent(pathname)}`)\n\t\t}\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [user])\n\n\treturn children\n}\n"],"names":["useAuth","usePathname","useRouter","useEffect","TOTPProviderClient","args","children","forceSetup","setupUrl","verifyUrl","user","strategy","_strategy","router","pathname","hasTotp","includes","push","encodeURIComponent"],"mappings":"AAAA,wCAAwC,GAExC;AAEA,SAASA,OAAO,QAAQ,iBAAgB;AACxC,SAASC,WAAW,EAAEC,SAAS,QAAQ,qBAAoB;AAC3D,SAASC,SAAS,QAAQ,QAAO;AAWjC,eAAe,SAASC,mBAAmBC,IAAU;IACpD,MAAM,EAAEC,QAAQ,EAAEC,UAAU,EAAEC,QAAQ,EAAEC,SAAS,EAAE,GAAGJ;IACtD,MAAM,EAAEK,IAAI,EAAE,GAAGV;IACjB,MAAMW,WAAYD,MAAcE;IAChC,MAAMC,SAASX;IACf,MAAMY,WAAWb;IAEjBE,UAAU;QACT,IACCO,QACAA,KAAKK,OAAO,IACZJ,YACA,CAAC;YAAC;YAAW;SAAO,CAACK,QAAQ,CAACL,aAC9BG,aAAaL,WACZ;YACDI,OAAOI,IAAI,CAAC,GAAGR,UAAU,MAAM,EAAES,mBAAmBJ,WAAW;QAChE,OAAO,IACNJ,QACA,CAACA,KAAKK,OAAO,IACbR,cACAO,aAAaN,YACbG,aAAa,WACZ;YACDE,OAAOI,IAAI,CAAC,GAAGT,SAAS,MAAM,EAAEU,mBAAmBJ,WAAW;QAC/D;IACA,uDAAuD;IACxD,GAAG;QAACJ;KAAK;IAET,OAAOJ;AACR"}