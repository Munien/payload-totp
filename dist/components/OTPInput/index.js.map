{"version":3,"sources":["../../../src/components/OTPInput/index.tsx"],"sourcesContent":["/* eslint-disable no-restricted-exports */\n\n'use client'\n\nimport type { FormEvent } from 'react'\n\nimport { useCallback, useRef } from 'react'\n\nimport { cn } from '../../utilities/cn.js'\nimport styles from './index.module.scss'\n\ntype Args = {\n\tdisabled?: boolean\n\tlength?: number\n\tname?: string\n\tonFilled?: (value: string) => void\n}\n\nexport default function OTPInput({ name, disabled, length = 6, onFilled }: Args) {\n\tconst inputs = useRef<HTMLInputElement[]>(Array(length).fill(null))\n\tconst hiddenInput = useRef<HTMLInputElement>(null)\n\tconst isFilled = hiddenInput.current?.value.length === length\n\n\tconst moveToPrev = (currentIndex: number) => {\n\t\tif (currentIndex > 0) {\n\t\t\tconst prevInput = inputs.current[currentIndex - 1]\n\t\t\tif (prevInput) {\n\t\t\t\tfocusAndSelectInput(prevInput)\n\t\t\t}\n\t\t}\n\t}\n\n\tconst moveToNext = useCallback(\n\t\t(currentIndex: number) => {\n\t\t\tif (currentIndex < length - 1) {\n\t\t\t\tconst nextInput = inputs.current[currentIndex + 1]\n\t\t\t\tif (nextInput) {\n\t\t\t\t\tfocusAndSelectInput(nextInput)\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t[length],\n\t)\n\n\tconst updateInputValue = useCallback(() => {\n\t\tif (hiddenInput.current) {\n\t\t\tconst value = inputs.current\n\t\t\t\t.filter(Boolean)\n\t\t\t\t.map((e) => e.value)\n\t\t\t\t.join('')\n\n\t\t\thiddenInput.current.value = value\n\n\t\t\tif (onFilled && value.length === length) {\n\t\t\t\tonFilled(value)\n\t\t\t}\n\t\t}\n\t}, [onFilled, length])\n\n\tconst onInput = (event: FormEvent<HTMLInputElement>, index: number) => {\n\t\tconst nativeEvent = event.nativeEvent as InputEvent\n\n\t\tif (nativeEvent.inputType === 'deleteContentBackward') {\n\t\t\tmoveToPrev(index)\n\t\t} else if (\n\t\t\tnativeEvent.inputType === 'insertText' ||\n\t\t\tnativeEvent.inputType === 'deleteContentForward'\n\t\t) {\n\t\t\tmoveToNext(index)\n\t\t}\n\n\t\tupdateInputValue()\n\t}\n\n\tconst onKeyDown = useCallback(\n\t\t(event: React.KeyboardEvent<HTMLInputElement>, index: number) => {\n\t\t\tif (event.nativeEvent.altKey || event.ctrlKey || event.metaKey) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tconst target = event.target as HTMLInputElement\n\t\t\tconst isDigitKey = /^\\d$/.test(event.key)\n\t\t\tconst isNumericKey =\n\t\t\t\tisDigitKey ||\n\t\t\t\tevent.code?.startsWith('Digit') ||\n\t\t\t\tevent.code?.startsWith('Numpad') ||\n\t\t\t\tevent.key === 'Unidentified'\n\n\t\t\tswitch (event.key) {\n\t\t\t\tcase 'ArrowDown':\n\t\t\t\tcase 'ArrowUp':\n\t\t\t\t\tevent.preventDefault()\n\t\t\t\t\tbreak\n\t\t\t\tcase 'ArrowLeft':\n\t\t\t\t\tmoveToPrev(index)\n\t\t\t\t\tevent.preventDefault()\n\t\t\t\t\tbreak\n\n\t\t\t\tcase 'ArrowRight':\n\t\t\t\t\tmoveToNext(index)\n\t\t\t\t\tevent.preventDefault()\n\t\t\t\t\tbreak\n\n\t\t\t\tcase 'Backspace':\n\t\t\t\t\tif (target.value.length === 0) {\n\t\t\t\t\t\tmoveToPrev(index)\n\t\t\t\t\t\tupdateInputValue()\n\t\t\t\t\t\tevent.preventDefault()\n\t\t\t\t\t} else if (target.selectionStart === 0) {\n\t\t\t\t\t\ttarget.value = ''\n\t\t\t\t\t\tmoveToPrev(index)\n\t\t\t\t\t\tupdateInputValue()\n\t\t\t\t\t\tevent.preventDefault()\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak\n\n\t\t\t\tdefault:\n\t\t\t\t\tif (!isNumericKey) {\n\t\t\t\t\t\tevent.preventDefault()\n\t\t\t\t\t}\n\n\t\t\t\t\tif (isDigitKey && target.value.length >= 1) {\n\t\t\t\t\t\tevent.preventDefault()\n\t\t\t\t\t\ttarget.value = event.key\n\t\t\t\t\t\tupdateInputValue()\n\t\t\t\t\t\tmoveToNext(index)\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak\n\t\t\t}\n\t\t},\n\t\t[moveToNext, updateInputValue],\n\t)\n\n\tconst onPaste = useCallback(\n\t\t(event: React.ClipboardEvent) => {\n\t\t\tevent.preventDefault()\n\n\t\t\tif (!disabled) {\n\t\t\t\tlet paste = event.clipboardData\n\t\t\t\t\t.getData('text')\n\t\t\t\t\t.trim()\n\t\t\t\t\t.split('')\n\t\t\t\t\t.filter((ch) => !isNaN(parseInt(ch)))\n\n\t\t\t\tif (paste.length > length) {\n\t\t\t\t\tpaste = paste.slice(0, length)\n\t\t\t\t}\n\n\t\t\t\tpaste.forEach((char, index) => {\n\t\t\t\t\tconst el = inputs.current[index]\n\t\t\t\t\tif (el) {\n\t\t\t\t\t\tel.value = char\n\t\t\t\t\t}\n\t\t\t\t})\n\n\t\t\t\tfocusAndSelectInput(inputs.current[paste.length - 1])\n\t\t\t\tupdateInputValue()\n\t\t\t}\n\t\t},\n\t\t[length, disabled, updateInputValue],\n\t)\n\n\tconst onHiddenInput = useCallback(\n\t\t(event: FormEvent<HTMLInputElement>) => {\n\t\t\tif (disabled) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tconst rawValue = event.currentTarget.value\n\n\t\t\tlet sanitizedValue = rawValue\n\t\t\t\t.trim()\n\t\t\t\t.split('')\n\t\t\t\t.filter((ch) => !isNaN(parseInt(ch)))\n\n\t\t\tif (sanitizedValue.length > length) {\n\t\t\t\tsanitizedValue = sanitizedValue.slice(0, length)\n\t\t\t}\n\n\t\t\tsanitizedValue.forEach((char, index) => {\n\t\t\t\tconst el = inputs.current[index]\n\t\t\t\tif (el) {\n\t\t\t\t\tel.value = char\n\t\t\t\t}\n\t\t\t})\n\n\t\t\tfocusAndSelectInput(inputs.current[sanitizedValue.length - 1])\n\n\t\t\tif (onFilled && sanitizedValue.length === length) {\n\t\t\t\tonFilled(sanitizedValue.join(''))\n\t\t\t}\n\t\t},\n\t\t[length, disabled, onFilled],\n\t)\n\n\treturn (\n\t\t<>\n\t\t\t{/* eslint-disable-next-line jsx-a11y/control-has-associated-label */}\n\t\t\t<input\n\t\t\t\tautoComplete=\"one-time-code\"\n\t\t\t\tinputMode=\"numeric\"\n\t\t\t\tname={name}\n\t\t\t\tonInput={(e) => onHiddenInput(e)}\n\t\t\t\tref={hiddenInput}\n\t\t\t\tstyle={{\n\t\t\t\t\tborder: 0,\n\t\t\t\t\tclip: 'rect(0,0,0,0)',\n\t\t\t\t\theight: '1px',\n\t\t\t\t\tmargin: '-1px',\n\t\t\t\t\toverflow: 'hidden',\n\t\t\t\t\tpadding: 0,\n\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\twidth: '1px',\n\t\t\t\t}}\n\t\t\t/>\n\t\t\t<div className={cn(styles.root, disabled && styles.disabled)}>\n\t\t\t\t{Array.from({ length }, (_, index) => index).map((i) => (\n\t\t\t\t\t// eslint-disable-next-line jsx-a11y/control-has-associated-label\n\t\t\t\t\t<input\n\t\t\t\t\t\t// eslint-disable-next-line jsx-a11y/no-autofocus\n\t\t\t\t\t\tautoFocus={i === 0}\n\t\t\t\t\t\t// Tell 1password to ignore this input\n\t\t\t\t\t\t// https://developer.1password.com/docs/web/compatible-website-design\n\t\t\t\t\t\tdata-1p-ignore={true}\n\t\t\t\t\t\tdisabled={disabled}\n\t\t\t\t\t\tinputMode=\"numeric\"\n\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\tmaxLength={1}\n\t\t\t\t\t\tonInput={(e) => onInput(e, i)}\n\t\t\t\t\t\tonKeyDown={(e) => onKeyDown(e, i)}\n\t\t\t\t\t\tonPaste={(e) => onPaste(e)}\n\t\t\t\t\t\tref={(el) => {\n\t\t\t\t\t\t\tif (el) {\n\t\t\t\t\t\t\t\tinputs.current[i] = el\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}}\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t/>\n\t\t\t\t))}\n\t\t\t\t<div className={styles.focus}></div>\n\t\t\t\t<div className={cn(styles.glow, isFilled && styles.expandGlow)}>\n\t\t\t\t\t{Array.from({ length }, (_, index) => index).map((i) => (\n\t\t\t\t\t\t<div key={i}></div>\n\t\t\t\t\t))}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</>\n\t)\n}\n\nfunction focusAndSelectInput(element: HTMLInputElement): void {\n\telement.focus()\n\telement.select()\n}\n"],"names":["useCallback","useRef","cn","styles","OTPInput","name","disabled","length","onFilled","inputs","Array","fill","hiddenInput","isFilled","current","value","moveToPrev","currentIndex","prevInput","focusAndSelectInput","moveToNext","nextInput","updateInputValue","filter","Boolean","map","e","join","onInput","event","index","nativeEvent","inputType","onKeyDown","altKey","ctrlKey","metaKey","target","isDigitKey","test","key","isNumericKey","code","startsWith","preventDefault","selectionStart","onPaste","paste","clipboardData","getData","trim","split","ch","isNaN","parseInt","slice","forEach","char","el","onHiddenInput","rawValue","currentTarget","sanitizedValue","input","autoComplete","inputMode","ref","style","border","clip","height","margin","overflow","padding","position","width","div","className","root","from","_","i","autoFocus","data-1p-ignore","maxLength","type","focus","glow","expandGlow","element","select"],"mappings":"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"}